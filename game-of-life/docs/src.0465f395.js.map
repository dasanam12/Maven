{"version":3,"sources":["../../node_modules/noliter/dist/index.esm.js","../engine.ts","../index.ts"],"names":["createElement","tagName","builder","element","document","removeChildren","parent","lastChild","removeChild","createObserver","initialValue","key","value","subscribers","newValue","k","callback","listenerKey"],"mappings":"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","file":"src.0465f395.js","sourceRoot":"..\\src\\static","sourcesContent":["function createElement(tagName, builder) {\r\n    var element = document.createElement(tagName);\r\n    if (builder) {\r\n        builder(element);\r\n    }\r\n    return element;\r\n}\r\nfunction removeChildren(parent) {\r\n    while (parent.lastChild) {\r\n        parent.removeChild(parent.lastChild);\r\n    }\r\n}\n\nfunction createObserver(initialValue) {\r\n    var key = 0;\r\n    var value = initialValue;\r\n    var subscribers = {};\r\n    return [\r\n        function getValue() {\r\n            return value;\r\n        },\r\n        function setValue(newValue) {\r\n            value = newValue;\r\n            for (var k in subscribers) {\r\n                subscribers[k](value);\r\n            }\r\n        },\r\n        function subscribeValue(callback) {\r\n            subscribers[key] = callback;\r\n            return key++;\r\n        },\r\n        function unsubscribeValue(listenerKey) {\r\n            delete subscribers[listenerKey];\r\n        },\r\n    ];\r\n}\n\nexport { createElement, createObserver, removeChildren };\n","import { createElement } from 'noliter';\r\n\r\nenum DOTS_STYLE {\r\n  WIDTH = 16,\r\n  HEIGHT = 16,\r\n  MARGIN = 2,\r\n  DEAD_COLOR = '#FFF',\r\n  SURVIVE_COLOR = '#000',\r\n}\r\n\r\nconst BACKGROUND_COLOR = '#FFF';\r\n\r\nconst getCoordinateX = (x: number): number => {\r\n  return (DOTS_STYLE.MARGIN + DOTS_STYLE.WIDTH) * x + DOTS_STYLE.MARGIN;\r\n};\r\n\r\nconst getCoordinateY = (y: number): number => {\r\n  return (DOTS_STYLE.MARGIN + DOTS_STYLE.HEIGHT) * y + DOTS_STYLE.MARGIN;\r\n};\r\n\r\nexport class GameOfLifeEngine {\r\n  public canvas: HTMLCanvasElement;\r\n  public context: CanvasRenderingContext2D;\r\n  private life: Life[][];\r\n  private intervalKey: null | number = null;\r\n\r\n  constructor(life: Life[][]) {\r\n    const cvs = createElement('canvas');\r\n    const ctx = cvs.getContext('2d');\r\n    if (ctx) {\r\n      this.canvas = cvs;\r\n      this.context = ctx;\r\n      this.setLife(life);\r\n      this.startLife();\r\n    } else {\r\n      throw 'Failed to create context';\r\n    }\r\n  }\r\n\r\n  setLife(life: Life[][]): void {\r\n    this.life = life;\r\n    this.canvas.width = getCoordinateX(life[0].length);\r\n    this.canvas.height = getCoordinateY(life.length);\r\n  }\r\n\r\n  public clear(): void {\r\n    this.context.fillStyle = BACKGROUND_COLOR;\r\n    this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n  }\r\n\r\n  public startLife(): void {\r\n    if (!this.intervalKey) {\r\n      this.drawDots();\r\n      this.intervalKey = window.setInterval(() => {\r\n        this.life = this.life.map((children, i) => children.map((isSurvive, j) => this.nextLife(j, i, isSurvive)));\r\n        this.drawDots();\r\n      }, 500);\r\n    }\r\n  }\r\n\r\n  public stopLife(): void {\r\n    if (this.intervalKey !== null) {\r\n      window.clearInterval(this.intervalKey);\r\n      this.intervalKey = null;\r\n    }\r\n  }\r\n\r\n  protected drawDot(x: number, y: number): void {\r\n    this.context.fillRect(getCoordinateX(x), getCoordinateY(y), DOTS_STYLE.WIDTH, DOTS_STYLE.HEIGHT);\r\n  }\r\n\r\n  protected drawDots(): void {\r\n    this.clear();\r\n    this.life.forEach((children, i) => {\r\n      children.forEach((isSurvive, j) => {\r\n        this.context.fillStyle = isSurvive ? DOTS_STYLE.SURVIVE_COLOR : DOTS_STYLE.DEAD_COLOR;\r\n        this.drawDot(j, i);\r\n      });\r\n    });\r\n  }\r\n\r\n  protected isSurvive(x: number, y: number): Life {\r\n    return this.life[y] && this.life[y][x] ? 1 : 0;\r\n  }\r\n\r\n  protected nextLife(x: number, y: number, isSurvive: Life): Life {\r\n    const count = this.isSurvive(x - 1, y - 1) + this.isSurvive(x, y - 1) + this.isSurvive(x + 1, y - 1) + this.isSurvive(x - 1, y) + this.isSurvive(x + 1, y) + this.isSurvive(x - 1, y + 1) + this.isSurvive(x, y + 1) + this.isSurvive(x + 1, y + 1);\r\n    return count === 3 || (isSurvive && count === 2) ? 1 : 0;\r\n  }\r\n}\r\n","import { createElement } from 'noliter';\r\nimport { GameOfLifeEngine } from './engine';\r\n\r\nconst engine = new GameOfLifeEngine([[]]);\r\nconst select = document.getElementById('patterns') as HTMLSelectElement;\r\nconst fetchLife = () =>\r\n  fetch(`./patterns/${select.value}`)\r\n    .then((res) => res.json())\r\n    .then(({ life }) => {\r\n      engine.stopLife();\r\n      engine.setLife(life);\r\n      engine.startLife();\r\n    });\r\n\r\nselect.addEventListener('change', () => fetchLife());\r\ndocument.body.appendChild(\r\n  createElement('main', (main) => {\r\n    main.appendChild(engine.canvas);\r\n    fetchLife();\r\n  })\r\n);\r\n"]}